<div class="container mt-4">
  <div class="card shadow border-0">
    <div class="card-header bg-primary text-white p-3">
      <h3 class="mb-0"><i class="bi bi-calendar-event"></i> Agenda da PensÃ£o</h3>
    </div>
    <div class="card-body p-4">
      <full-calendar [options]="calendarOptions"></full-calendar>
    </div>
  </div>
</div>

<div class="modal fade" id="modalEvento" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 shadow-lg" style="border-radius: 20px; overflow: hidden;">
      
      <div class="modal-header border-0 p-4" 
           style="background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);">
          <h5 class="modal-title fw-bold text-white">
            <i class="bi bi-calendar-check me-2"></i>
            {{ eventoIdSelecionado ? 'Editar' : 'Novo' }} Agendamento: 
            {{ (dataSelecionada | date:'dd/MM/yyyy':'UTC') || dataSelecionada || 'Data pendente' }}
          </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body p-4 bg-light">
        <div class="card border-0 shadow-sm p-3 mb-3" style="border-radius: 15px;">
          <label class="form-label fw-bold text-primary small mb-1">O QUE VAMOS MARCAR?</label>
          <input type="text" class="form-control border-0 p-0" 
                 [(ngModel)]="novoEventoTitulo" 
                 placeholder="Ex: Consulta Dr. Silva"
                 style="font-size: 1.1rem; background: transparent; box-shadow: none;">
        </div>
        
        <div class="card border-0 shadow-sm p-3" style="border-radius: 15px;">
          <label class="form-label fw-bold text-primary small mb-1">CATEGORIA</label>
          <select class="form-select border-0 p-0" 
                  [(ngModel)]="categoriaSelecionada"
                  style="background: transparent; cursor: pointer; box-shadow: none; font-weight: 500;">
            <option [value]="1">ðŸ”µ Visita</option>
            <option [value]="2">ðŸŸ¡ Escola</option>
            <option [value]="3">ðŸŸ¢ SaÃºde</option>
            <option [value]="4">ðŸ”´ Financeiro</option>
          </select>
        </div>
      </div>

      <div *ngIf="!eventoAtivoSelecionado" class="px-4 mb-2">
        <div class="alert alert-warning border-0 d-flex align-items-center mb-0 py-2" 
            style="border-radius: 10px; font-size: 0.85rem; background-color: #fff3cd; color: #856404;">
          <i class="bi bi-exclamation-triangle-fill me-2"></i>
          <span>Este agendamento foi cancelado e nÃ£o pode ser editado.</span>
        </div>
      </div>

      <div class="modal-footer border-0 bg-light pb-4 px-4 d-flex justify-content-between align-items-center">
        
        <div class="dropdown" *ngIf="eventoIdSelecionado && eventoAtivoSelecionado">
          <button class="btn btn-link text-secondary p-0 border-0" 
                  type="button" 
                  data-bs-toggle="dropdown" 
                  aria-expanded="false"
                  style="box-shadow: none;">
            <i class="bi bi-three-dots-vertical fs-5"></i>
          </button>
          <ul class="dropdown-menu shadow border-0" style="border-radius: 10px;">
            <li>
              <a class="dropdown-item text-danger fw-bold" (click)="excluirEvento()">
                  <i class="bi bi-trash me-2"></i> EXCLUIR AGENDAMENTO
              </a>
            </li>
          </ul>
        </div>

        <div class="d-flex gap-2 align-items-center">
          <button type="button" 
                  class="btn btn-link text-secondary fw-bold text-decoration-none" 
                  data-bs-dismiss="modal">
            Sair
          </button>
          
          <button type="button" 
                  class="btn btn-primary px-4 py-2 fw-bold shadow-sm" 
                  (click)="salvarEvento()" 
                  [disabled]="!eventoAtivoSelecionado"
                  [style.opacity]="eventoAtivoSelecionado ? '1' : '0.5'"
                  style="border-radius: 12px; background: #1e3a8a; border: none; min-width: 110px;">
            {{ eventoIdSelecionado ? 'Atualizar' : 'Confirmar' }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>